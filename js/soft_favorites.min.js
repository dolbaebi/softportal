function addToFavorites(e,t){var o=0,o=getValue("visitor_id");if(!o)return afterAuthFunction="addToFavorites("+e+");",void showFloatAuthForm();"undefined"==typeof t&&(t=0);var a="ajax.php",r={dj:0,module:"soft_favorites",response_xml:!0,soft_id:e,subs:t,event:"add"};document.body.style.cursor="wait";new Ajax.Request(a,{method:"get",parameters:r,asynchronous:!1,onFailure:function(){alert("Запрос AJAX закончился неудачей"),document.body.style.cursor="default"},onSuccess:function(e){document.body.style.cursor="default";var t=e.responseXML,o=t.getElementsByTagName("root")[0],a=o.getElementsByTagName("error")[0].childNodes[0];if(a)return void alert(a.nodeValue);var r=o.getElementsByTagName("result")[0];if(r.getElementsByTagName("error")[0]&&r.getElementsByTagName("error")[0].childNodes[0]&&alert(r.getElementsByTagName("error")[0].childNodes[0].nodeValue),r.getElementsByTagName("message")[0]&&r.getElementsByTagName("message")[0].childNodes[0]&&alert(r.getElementsByTagName("message")[0].childNodes[0].nodeValue),r.getElementsByTagName("count")[0]&&r.getElementsByTagName("count")[0].childNodes[0]){var s=r.getElementsByTagName("count")[0].childNodes[0].nodeValue;$("favorites_count").innerHTML="&nbsp;("+s+")"}}})}function removeFromFavorites(e,t){var o=0,o=getValue("visitor_id");if(!o)return afterAuthFunction="removeFromFavorites("+e+", "+t+");",void showFloatAuthForm();if(0!=confirm('Удалить из "Избранных программ"?')){var a="ajax.php",r={dj:0,module:"soft_favorites",response_xml:!0,soft_id:e,event:"remove"};document.body.style.cursor="wait";{new Ajax.Request(a,{method:"get",parameters:r,asynchronous:!1,onFailure:function(){alert("Запрос AJAX закончился неудачей"),document.body.style.cursor="default"},onSuccess:function(o){document.body.style.cursor="default";var a=o.responseXML,r=a.getElementsByTagName("root")[0],s=r.getElementsByTagName("error")[0].childNodes[0];if(s)return void alert(s.nodeValue);$("row_"+e).hide();var n=r.getElementsByTagName("result")[0];if(n.getElementsByTagName("error")[0]&&n.getElementsByTagName("error")[0].childNodes[0]&&alert(n.getElementsByTagName("error")[0].childNodes[0].nodeValue),n.getElementsByTagName("message")[0]&&n.getElementsByTagName("message")[0].childNodes[0]&&alert(n.getElementsByTagName("message")[0].childNodes[0].nodeValue),n.getElementsByTagName("count")[0]&&n.getElementsByTagName("count")[0].childNodes[0]){var l=n.getElementsByTagName("count")[0].childNodes[0].nodeValue;$("fav_count").innerHTML=l,$(t)&&--$("span_count_"+t).innerHTML,0==l&&($("row_fav_not_empty")&&$("row_fav_not_empty").hide(),$("row_fav_is_empty").show())}}})}}}function subscribe(e){var t=0,t=getValue("visitor_id");if(!t)return afterAuthFunction="removeFromFavorites("+e+");",void showFloatAuthForm();var o="ajax.php",a={dj:0,module:"soft_favorites",response_xml:!0,soft_id:e,event:"subscribe"};document.body.style.cursor="wait";new Ajax.Request(o,{method:"get",parameters:a,asynchronous:!1,onFailure:function(){alert("Запрос AJAX закончился неудачей"),document.body.style.cursor="default"},onSuccess:function(t){document.body.style.cursor="default";var o=t.responseXML,a=o.getElementsByTagName("root")[0],r=a.getElementsByTagName("error")[0].childNodes[0];if(r)return void alert(r.nodeValue);var s=a.getElementsByTagName("result")[0];if(s.getElementsByTagName("error")[0]&&s.getElementsByTagName("error")[0].childNodes[0]&&alert(s.getElementsByTagName("error")[0].childNodes[0].nodeValue),s.getElementsByTagName("message")[0]&&s.getElementsByTagName("message")[0].childNodes[0]&&alert(s.getElementsByTagName("message")[0].childNodes[0].nodeValue),s.getElementsByTagName("ok")[0]&&s.getElementsByTagName("ok")[0].childNodes[0]){var n=s.getElementsByTagName("ok")[0].childNodes[0].nodeValue;1==n&&($("span_subs_"+e).innerHTML='<a href="javascript:void(null);" onClick="unsubscribe('+e+');"><img src="/img/main/ico/ico4.gif" width="19" height="19" alt="Отписаться" title="Отписаться"></a>')}}})}function unsubscribe(e){var t=0,t=getValue("visitor_id");if(!t)return afterAuthFunction="removeFromFavorites("+e+");",void showFloatAuthForm();var o="ajax.php",a={dj:0,module:"soft_favorites",response_xml:!0,soft_id:e,event:"unsubscribe"};document.body.style.cursor="wait";new Ajax.Request(o,{method:"get",parameters:a,asynchronous:!1,onFailure:function(){alert("Запрос AJAX закончился неудачей"),document.body.style.cursor="default"},onSuccess:function(t){document.body.style.cursor="default";var o=t.responseXML,a=o.getElementsByTagName("root")[0],r=a.getElementsByTagName("error")[0].childNodes[0];if(r)return void alert(r.nodeValue);var s=a.getElementsByTagName("result")[0];if(s.getElementsByTagName("error")[0]&&s.getElementsByTagName("error")[0].childNodes[0]&&alert(s.getElementsByTagName("error")[0].childNodes[0].nodeValue),s.getElementsByTagName("message")[0]&&s.getElementsByTagName("message")[0].childNodes[0]&&alert(s.getElementsByTagName("message")[0].childNodes[0].nodeValue),s.getElementsByTagName("ok")[0]&&s.getElementsByTagName("ok")[0].childNodes[0]){var n=s.getElementsByTagName("ok")[0].childNodes[0].nodeValue;1==n&&($("span_subs_"+e).innerHTML='<a href="javascript:void(null);" onClick="subscribe('+e+');"><img src="/img/main/ico/ico4o.gif" width="19" height="19" alt="Подписаться" title="Подписаться"></a>')}}})}function removeFavoritesCategory(e){var t=0,t=getValue("visitor_id");if(!t)return afterAuthFunction="removeFavoritesCategory("+e+");",void showFloatAuthForm();if(0!=confirm("Удалить эту категорию?")){var o="ajax.php",a={dj:0,module:"soft_favorites",response_xml:!0,category_id:e,event:"remove_category"};document.body.style.cursor="wait";{new Ajax.Request(o,{method:"get",parameters:a,asynchronous:!1,onFailure:function(){alert("Запрос AJAX закончился неудачей"),document.body.style.cursor="default"},onSuccess:function(t){document.body.style.cursor="default";var o=t.responseXML,a=o.getElementsByTagName("root")[0],r=a.getElementsByTagName("error")[0].childNodes[0];if(r)return void alert(r.nodeValue);var s=a.getElementsByTagName("result")[0];return s.getElementsByTagName("error")[0]&&s.getElementsByTagName("error")[0].childNodes[0]?void alert(s.getElementsByTagName("error")[0].childNodes[0].nodeValue):s.getElementsByTagName("alert")[0]&&s.getElementsByTagName("alert")[0].childNodes[0]?void alert(s.getElementsByTagName("alert")[0].childNodes[0].nodeValue):(s.getElementsByTagName("message")[0]&&s.getElementsByTagName("message")[0].childNodes[0]&&alert(s.getElementsByTagName("message")[0].childNodes[0].nodeValue),void $("row_"+e).hide())}})}return!0}}function removeFromVisitorLinks(e,t){var o=0,o=getValue("visitor_id");if(!o)return afterAuthFunction="removeFromVisitorLinks("+e+", "+t+");",void showFloatAuthForm();if(0!=confirm("Удалить пользовательскую ссылку?")){var a="ajax.php",r={dj:0,module:"soft_favorites",response_xml:!0,link_id:e,event:"remove_visitor_link"};document.body.style.cursor="wait";{new Ajax.Request(a,{method:"get",parameters:r,asynchronous:!1,onFailure:function(){alert("Запрос AJAX закончился неудачей"),document.body.style.cursor="default"},onSuccess:function(o){document.body.style.cursor="default";var a=o.responseXML,r=a.getElementsByTagName("root")[0],s=r.getElementsByTagName("error")[0].childNodes[0];if(s)return void alert(s.nodeValue);var n=r.getElementsByTagName("result")[0];if(n.getElementsByTagName("error")[0]&&n.getElementsByTagName("error")[0].childNodes[0])return void alert(n.getElementsByTagName("error")[0].childNodes[0].nodeValue);if(n.getElementsByTagName("message")[0]&&n.getElementsByTagName("message")[0].childNodes[0]&&alert(n.getElementsByTagName("message")[0].childNodes[0].nodeValue),$("row_"+e).hide(),n.getElementsByTagName("count")[0]&&n.getElementsByTagName("count")[0].childNodes[0]){var l=n.getElementsByTagName("count")[0].childNodes[0].nodeValue;$("fav_count").innerHTML=l,$(t)&&--$("span_count_"+t).innerHTML,0==l&&($("row_fav_not_empty")&&$("row_fav_not_empty").hide(),$("row_fav_is_empty").show())}}})}}}function getVisitorLinkPassword(e){var t=0,t=getValue("visitor_id");if(!t)return afterAuthFunction="showSecretPassword("+e+");",void showFloatAuthForm();var o="ajax.php",a={dj:0,module:"soft_favorites",response_xml:!0,link_id:e,event:"get_visitor_link_password"};document.body.style.cursor="wait";{var r="";new Ajax.Request(o,{method:"get",parameters:a,asynchronous:!1,onFailure:function(){alert("Запрос AJAX закончился неудачей"),document.body.style.cursor="default"},onSuccess:function(e){document.body.style.cursor="default";var t=e.responseXML,o=t.getElementsByTagName("root")[0],a=o.getElementsByTagName("error")[0].childNodes[0];return a?(alert(a.nodeValue),void(r=!1)):void(r=o.getElementsByTagName("result")[0])}})}return r}