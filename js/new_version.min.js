function newVersion(e,t){return void showNewVersionForm(e,t)}function showNewVersionForm(e,t){$("divFloatNewVersion")?rebuildFormCode():printNewVersionForm(t);var i=getWindowScroll(),n=getWindowDimensions(),r=$("divFloatNewVersion").getDimensions();$("divFloatNewVersion").style.left=parseInt(n.x/2)-parseInt(r.width/2)+i.x+"px",$("divFloatNewVersion").style.top=parseInt(n.y/2)-parseInt(r.height/2)+i.y+"px","-"==$("divFloatNewVersion").style.left.substr(0,1)&&($("divFloatNewVersion").style.left="-3px"),$("divLoadingNewVersion").style.height=r.height-10+"px",$("divLoadingNewVersion").style.width=r.width+"px",$("divLoadingNewVersion").hide(),$("divNewVersionForm").show(),new Effect.Appear("divFloatNewVersion")}function hideFloatNewVersion(){$("divFloatNewVersion").hide(),$("divResultNewVersion").hide()}function sendNewVersionForm(e){var t=checkNewVersionForm();if(""!=t)return alert("Найдены ошибки при отправке формы:\n\n"+t),!1;$("divNewVersionForm").hide(),$("divLoadingNewVersion").show();{var i="ajax.php",n={dj:0,module:"new_version",soft_id:e,name:$("name").value,email:$("email").value,ver:$("ver").value,url:$("url").value,what_new:$("what_new").value,code:$("code").value};new Ajax.Request(i,{method:"get",parameters:n,asynchronous:!1,onFailure:function(){$("divLoadingNewVersion").hide(),$("divResultNewVersionText").innerHTML="Запрос AJAX закончился неудачей.",$("divResultNewVersion").show(),$("btnCloseResultNewVersion").focus()},onSuccess:function(e,t){$("divLoadingNewVersion").hide(),""!=t.error?$("divResultNewVersionText").innerHTML="<div style='text-align:left;'>Произошла ошибка:<br><br><span style='color:red;'>"+t.error+"</span></div>":""!=t.result&&($("divResultNewVersionText").innerHTML=t.result),$("divResultNewVersion").show(),$("btnCloseResultNewVersion").focus(),resetNewVersionForm()}})}return!1}function checkNewVersionForm(){var e="";return""==$("name").value&&(e+=" - Вы не ввели свое имя\n"),""==$("email").value&&(e+=" - Вы не ввели свой e-mail\n"),""==$("ver").value&&(e+=" - Вы не ввели номер новой версии\n"),""==$("url").value&&(e+=" - Вы не ввели линк (URL) на новую версию программы\n"),(""==$("what_new").value||-1!=$("what_new").value.indexOf("Опишите нововведения"))&&(e+=" - Вы не ввели описанине изменений в новой версии\n"),""==$("code").value&&(e+=" - Вы не ввели код\n"),e}function resetNewVersionForm(){""==$("name").value,""==$("email").value,""==$("ver").value,""==$("url").value,"Опишите нововведения или улучшения, которые отличают новую версию от предыдущей!"==$("what_new").value,""==$("code").value,rebuildFormCode()}function rebuildFormCode(){$("code").value="",$("form_code").src="/kcaptcha/index.php?rand="+Math.random()}function printNewVersionForm(e){var t=getValue("visitor_nickname"),i=getValue("visitor_email"),n='<div id="divFloatNewVersion" class="divFloat" style="display:none; width:600px; height:400px; text-align:center; padding:0; position:absolute;">';n+='<img src="/img/close.gif" width="11" height="11" border="0" onClick="hideFloatNewVersion();" alt="Закрыть" align="right" style="cursor:pointer; margin:0; z-index:100;">',n+='<div id="divLoadingNewVersion" class="divLoading" style="display:none;">Подождите, идет загрузка...</div>',n+='<div id="divNewVersionForm" style="text-align:left; margin:20px 20px 25px;">',n+='<FORM name="newVersionForm" id="newVersionForm" method="post" onSubmit="sendNewVersionForm('+e+'); return false;">',n+='<table cellpadding="0" width="100%" class="TblDesc">',n+='<tr><td colspan="2"><span class="geo24">Сообщение о выходе новой версии</span><p /></td></tr>',n+='<tr><td colspan="2" bgcolor="#f0f0f0" style="height:8px; font-size:0px;"><!--  --></td></tr>',n+='<tr><td colspan="2" class="DivTd"><img src="/img/_n.gif" width="1" height="1" alt="" /></td></tr>',n+='<tr><td align="right" width="30%">Ваше имя: </td><td><input type="text" name="name" id="name" style="width:145px; font-size:11px;" value="'+t+'"></td></tr>',n+='<tr><td colspan="2" class="DivTd"><!--  --></td></tr>',n+='<tr><td align="right">Ваш e-mail: </td><td><input type="text" name="email" id="email" style="width:145px; font-size:11px;" value="'+i+'"></td></tr>',n+='<tr><td colspan="2" class="DivTd"><!--  --></td></tr>',n+='<tr><td align="right">Номер новой версии: </td><td><input type="text" name="ver" id="ver" style="width:100px; font-size:11px;"></td></tr>',n+='<tr><td colspan="2" class="DivTd"><!--  --></td></tr>',n+='<tr><td align="right">Линк (URL) на новую версию: </td><td><input type="text" name="url" id="url" style="width:345px; font-size:11px;"></td></tr>',n+='<tr><td colspan="2" class="DivTd"><!--  --></td></tr>',n+='<tr><td align="right" valign="top">Что нового в новой версии? </td><td style="padding-right:20px;"><textarea rows="4" style="width:100%" name="what_new" id="what_new">Опишите нововведения или улучшения, которые отличают новую версию от предыдущей!</textarea></td></tr>',n+='<tr><td colspan="2" class="DivTd"><!--  --></td></tr>',n+='<tr><td align="right" valign="top">Введите код,<br>&nbsp;изображенный на рисунке:</td><td style="height:30px;"><img src="/kcaptcha/index.php?rand="'+Math.random()+' alt="код формы" id="form_code"><br><input type="text" name="code" id="code" style="width:65px; font-size:11px;"> <a href="javascript:void(null);" onclick="rebuildFormCode()">Перегенерировать код</a></td></tr>',n+='<tr><td colspan="2" bgcolor="#f0f0f0" style="height:8px;font-size:0px;"><!--  --></td></tr>',n+='<tr><td colspan="2" align="right" style="padding:9px 20px 15px 0;"><input type="image" src="/img/bsend.gif" width="104" height="21" alt="Отправить"></td></tr>',n+="</table></FORM></div>",n+='<div id="divResultNewVersion" style="display:none; margin:120px 20px 25px;"><div id="divResultNewVersionText" class="taho11" style="font-weight:bold; text-align:left;"></div><br><input type="button" value="Закрыть" id="btnCloseResultNewVersion" onClick="hideFloatNewVersion();" class="taho11"></div></div>',new Insertion.After("content",n)}